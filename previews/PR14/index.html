<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · WangLandau.jl</title><meta name="title" content="Home · WangLandau.jl"/><meta property="og:title" content="Home · WangLandau.jl"/><meta property="twitter:title" content="Home · WangLandau.jl"/><meta name="description" content="Documentation for WangLandau.jl."/><meta property="og:description" content="Documentation for WangLandau.jl."/><meta property="twitter:description" content="Documentation for WangLandau.jl."/><meta property="og:url" content="https://christofbradly.github.io/WangLandau.jl/"/><meta property="twitter:url" content="https://christofbradly.github.io/WangLandau.jl/"/><link rel="canonical" href="https://christofbradly.github.io/WangLandau.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>WangLandau.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Wang-Landau-algorithm"><span>Wang-Landau algorithm</span></a></li><li><a class="tocitem" href="#Interface"><span>Interface</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><a class="tocitem" href="ising/">Example: 2D Ising model</a></li><li><a class="tocitem" href="advanced/">Advanced usage</a></li><li><a class="tocitem" href="api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/christofbradly/WangLandau.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/christofbradly/WangLandau.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="WangLandau.jl"><a class="docs-heading-anchor" href="#WangLandau.jl">WangLandau.jl</a><a id="WangLandau.jl-1"></a><a class="docs-heading-anchor-permalink" href="#WangLandau.jl" title="Permalink"></a></h1><p><code>WangLandau.jl</code> is a pure Julia implementation of the Wang-Landau Monte Carlo algorithm for statistical mechanics problems. The package defines a flexible interface that is designed to apply the algorithm to any user-defined problem.</p><ul><li><a href="#Wang-Landau-algorithm">Wang-Landau algorithm</a></li><li><a href="#Interface">Interface</a></li><li><a href="#References">References</a></li></ul><h2 id="Wang-Landau-algorithm"><a class="docs-heading-anchor" href="#Wang-Landau-algorithm">Wang-Landau algorithm</a><a id="Wang-Landau-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Wang-Landau-algorithm" title="Permalink"></a></h2><p>The Wang-Landau algorithm works by randomly sampling from a state space and iteratively updating a corresponding density of states until some accuracy criterion is achieved. </p><p>Suppose we initialise a system in state <span>$i$</span> (e.g. an Ising configuration on a lattice), which has energy <span>$E_i$</span>, and we propose a trial move to state <span>$j$</span>, which has energy <span>$E_j$</span>. The proposed state is accepted based on a Metropolis-like condition</p><p class="math-container">\[P(i \to j) = \min \left(1, \frac{g(E_i)}{g(E_j)} \right)\]</p><p>where <span>$g(E)$</span> is the density of states at energy <span>$E$</span>. Classically, the density of states is motivated by the Boltzmann distribution <span>$g(E) = \exp(-E)$</span>. A random roll is performed against <span>$P(i \to j)$</span> and either the proposed state or the original state is accepted as the next state. The sampled states are counted with a histogram <span>$h(E)$</span>, initially set to 0. When the next state, with energy <span>$E$</span>, is accepted, <span>$h$</span> is incremented to count the new state: <span>$h(E) \to h(E) + 1$</span> and the density of states is increased according to <span>$g(E) \to  f * g(E)$</span>, where <span>$f$</span> is a dynamic parameter.</p><p>A single iteration of the Wang-Landau algorithm is as follows: After a set number of trial moves, the histogram is checked to see if it is sufficiently &#39;flat&#39;, for example, <span>$\min h(E) \geq 0.8 \bar{h(E)}$</span>, where <span>$\bar{h(E)}$</span> is the average value of <span>$h$</span>. If the histogram is flat, then <span>$h$</span> is reset to 0, the parameter <span>$f$</span> is decreased, for example <span>$f \to \sqrt{f}$</span>, and a new iteration commences. </p><p>The algorithm terminates when <span>$f$</span> reaches a predetermined size, for example, one may initialise <span>$f = e \approx 2.718\ldots$</span> and after 14 iterations <span>$f &lt; 10^{-6}$</span>. At this point the error in the density of states is <span>$\sqrt{f}$</span>, and thermodynamic properties can be calculated from <span>$g(E)$</span>. For numerical accuracy, the density of states and the parameter <span>$f$</span> are usually handled with logarithms.</p><h2 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h2><p>WangLandau.jl adheres to the <a href="https://github.com/SciML/CommonSolve.jl">CommonSolve</a> interface.</p><pre><code class="language-julia hljs">prob = WangLandauProblem(::SetupType)
sim = CommonSolve.solve(prob; kwargs...)</code></pre><p>The <code>SetupType</code> should be defined by the user for a specific problem. Several methods should be defined by the user to dispatch on <code>SetupType</code>, see <a href="#user-defined-code">below</a> for details. The <code>kwargs</code> passed to <code>solve</code> define the parameters of the algorithm, and are ultimately passed to <a href="api/#WangLandau.WangLandauSimulation"><code>WangLandauSimulation</code></a>, which is the main internal <code>struct</code> and the output type of <code>sim</code>. <code>WangLandauSimulation</code> is not exported and should not be constructed explicitly, it is handled via the <code>CommonSolve</code> interface.</p><p>The main parameters include:</p><ul><li><code>check_sweeps</code>: A statistical mechanics problem will have some finite size <code>N</code> and a Monte Carlo sweep is <code>N</code> trial moves. <code>check_sweeps</code> controls how many sweeps to perform before checking if the histogram is flat. Checking too often can be inefficient and checking too rarely will mean the algorithm runs longer than necessary.</li><li><code>flat_tolerance</code>: defines the number <code>x</code> such that <span>$h(E)$</span> is considered flat when <span>$\min h \geq x \bar{h}$</span></li><li><code>final_logf</code>: when <span>$f$</span> reaches this value the algorithm terminates</li></ul><p>The output <code>sim::WangLandauSimulation</code> will contain two <code>Array</code>s:</p><ul><li><code>sim.samples</code>: the histogram of samples <span>$h(E)$</span></li><li><code>sim.logdos</code>: The (logarithm) of the density of states <span>$\log g(E)$</span></li></ul><h3 id="User-defined-code"><a class="docs-heading-anchor" href="#User-defined-code">User-defined code</a><a id="User-defined-code-1"></a><a class="docs-heading-anchor-permalink" href="#User-defined-code" title="Permalink"></a></h3><p>To use <code>WangLandau.jl</code> the user should define a number of custom types and then several methods to act on those types. </p><p>The types referred to are</p><ul><li><code>SetupType</code>: a struct that holds the necessary parameters to instantiate a sample configuration and define trial moves</li><li><code>StateType</code>: a data-structure that contains the configuration </li><li><code>TrialType</code>: data that defines how to perform a trial move between two states</li><li><code>IndexType</code>: an index for the histogram</li></ul><p>These types can be simple, for example, a lattice-spin model like the Ising model may use <code>Matrix{Int}</code> for <code>StateType</code>, and then <code>TrialType</code> indexes a single element in the matrix to perform a spin flip. <code>IndexType</code> should be <code>Int</code> for one-parameter histograms, otherwise <code>CartesianIndex</code> should be used.</p><p>Then the following methods should be defined</p><ul><li><a href="api/#WangLandau.histogram_size"><code>histogram_size</code></a>: the dimensions of the histogram.</li><li><a href="api/#WangLandau.system_size"><code>system_size</code></a>: the size of the system.</li><li><a href="api/#WangLandau.initialise_state"><code>initialise_state</code></a>: Optional initialisation step.</li><li><a href="api/#WangLandau.random_trial!"><code>random_trial!</code></a>: Obtain a trial move for a new state.</li><li><a href="api/#WangLandau.histogram_index"><code>histogram_index</code></a>: Obtain the histogram index for the new state</li><li><a href="api/#WangLandau.commit_trial!"><code>commit_trial!</code></a>: Upon acceptance of the trial move, update the state, optionally according to the indices.</li><li><a href="api/#WangLandau.revert_trial!-NTuple{5, Any}"><code>revert_trial!</code></a>: Upon rejection of the trial move, update the state, optionally according to the indices. By default returns <code>state</code></li></ul><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><ul><li>Original paper: <a href="https://link.aps.org/doi/10.1103/PhysRevLett.86.2050">Wang &amp; Landau, <em>PRL</em> 2001</a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="ising/">Example: 2D Ising model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Saturday 25 October 2025 00:47">Saturday 25 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
