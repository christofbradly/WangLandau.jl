<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example: 2D Ising model · WangLandau.jl</title><meta name="title" content="Example: 2D Ising model · WangLandau.jl"/><meta property="og:title" content="Example: 2D Ising model · WangLandau.jl"/><meta property="twitter:title" content="Example: 2D Ising model · WangLandau.jl"/><meta name="description" content="Documentation for WangLandau.jl."/><meta property="og:description" content="Documentation for WangLandau.jl."/><meta property="twitter:description" content="Documentation for WangLandau.jl."/><meta property="og:url" content="https://christofbradly.github.io/WangLandau.jl/ising/"/><meta property="twitter:url" content="https://christofbradly.github.io/WangLandau.jl/ising/"/><link rel="canonical" href="https://christofbradly.github.io/WangLandau.jl/ising/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">WangLandau.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Example: 2D Ising model</a><ul class="internal"><li><a class="tocitem" href="#The-Ising-model"><span>The Ising model</span></a></li><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Critical-point"><span>Critical point</span></a></li></ul></li><li><a class="tocitem" href="../advanced/">Advanced usage</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Example: 2D Ising model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example: 2D Ising model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/christofbradly/WangLandau.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/christofbradly/WangLandau.jl/blob/main/docs/src/ising.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Example:-2D-Ising-model"><a class="docs-heading-anchor" href="#Example:-2D-Ising-model">Example: 2D Ising model</a><a id="Example:-2D-Ising-model-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-2D-Ising-model" title="Permalink"></a></h1><ul><li><a href="#The-Ising-model">The Ising model</a></li><li><a href="#Setup">Setup</a></li><li><a href="#Simulation">Simulation</a></li><li><a href="#Critical-point">Critical point</a></li></ul><h2 id="The-Ising-model"><a class="docs-heading-anchor" href="#The-Ising-model">The Ising model</a><a id="The-Ising-model-1"></a><a class="docs-heading-anchor-permalink" href="#The-Ising-model" title="Permalink"></a></h2><p>The Ising model is a classic statistical mechanics model defined by a Hamiltonian</p><p class="math-container">\[H = -J \sum_{i \sim j} S_i S_j\]</p><p>where <span>$S_i \in (-1,1)$</span> is the spin of site <span>$i$</span>. The sum is over all adjacent pairs on a specified lattice. Here we assume that the interaction strength is in units where <span>$J = 1$</span> and we ignore any external magnetic field. We will apply this model on a square grid of size <span>$L \times L$</span> sites. This model is the simplest statistical mechanical system that exhibits a continuous phase transition.</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><p>To apply the Wang-Landau algorithm, we load <code>WangLandau</code> along with necessary definitions for the Ising model</p><pre><code class="language-julia hljs">using WangLandau, LinearAlgebra, Plots, LaTeXStrings;

include(&quot;../../examples/ising.jl&quot;);</code></pre><p>The main definition in <code>ising.jl</code> is the mutable struct <code>Ising2D</code>, which holds an integer array representing the configuration of spins and the energy of the configuration. The rest of the code defines methods for applying the <code>WangLandau</code> interface to <code>Ising2D</code> (see <a href="../api/#WangLandau.WangLandauProblem"><code>WangLandauProblem</code></a>). These methods define the histograms and specify how to make and accept random trial moves. For the Ising model a simple trial move is flipping a single spin at a random site on the lattice.</p><p>This example can have periodic or free boundary conditions, here we will define the problem for the case of free boundary conditions:</p><pre><code class="language-julia hljs">L = 15;

P = false;

prob = WangLandauProblem(Ising2D(L; periodic=P));</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">WangLandauProblem{Main.Ising2D{false, false}}(Main.Ising2D{false, false}([0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], 15, 420))</code></pre><p>When <code>Ising2D</code> is constructed it will initialise a random configuration of spins.</p><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><p>Next, we run the simulation. We will use the default strategies for altering the <span>$f$</span> parameter, but set a final desired value of <span>$f &lt; 10^{-6}$</span>. We can also set how often to check for flatness by setting the keyword <code>check_sweeps</code>. A single Monte Carlo sweep is <span>$N$</span> trial moves, where <span>$N$</span> is the canonical size of the system, in this case <span>$N = L^2$</span>.</p><pre><code class="language-julia hljs">sim = solve(prob; check_sweeps = 500, final_logf = 1e-6);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">WangLandauSimulation(Main.Ising2D{false, false}([0 0 … 0 0; 0 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 0 0], 15, 420))
  log(f) = 9.5367431640625e-7 (final: 1.0e-6)
  iterations: 20 (checks: 5247)
  total steps: 590287504
  elapsed time: 2.64e+01 s</code></pre><p>To see if the algorithm performed well, we should inspect the histogram of samples. The output <code>sim.samples</code> is the accumulation of the histogram at each iteration. </p><pre><code class="language-julia hljs">scatter(sim.samples; label = :none, ylabel = &quot;samples&quot;, msw = 0, ms = 2)</code></pre><img src="2eccc841.svg" alt="Example block output"/><p>If the histogram is flat then we can proceed to analysis.</p><p>The samples histogram is indexed by <span>$i \in 1,\ldots,i_\mathrm{max}$</span>, where <span>$i_\mathrm{max} = 2 (L - P)^2 + 2 (L - P)$</span> is the number of accessible energy values and <span>$P=0$</span> for free boundary and <span>$P=1$</span> for periodic boundary. This is more efficient for internal processing and the conversion to consecutive array indexing is handled by the <code>Ising2D</code> code. However, for physical analysis we want a range of real energy values. The extremal energy values for an <span>$L \times L$</span> lattice are <span>$\pm E_\mathrm{max}$</span> where <span>$E_\mathrm{max} = 2(L - (1 - P))^2 + 2(L - (1 - P))$</span>, and the change in energy from flipping a single spin is <span>$2(1+P)$</span>. In fact, <span>$E_\mathrm{max}$</span> is already stored in <code>Ising2D</code> so we can just define</p><pre><code class="language-julia hljs">maxE = sim.statedefn.maxE;

Es = -maxE:(2*(1 + P)):maxE;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-420:2:420</code></pre><p>Next, we look at the density of states, normalised to its maximum value. We also apply a mask to avoid any hard-to-reach states that were not sampled.</p><pre><code class="language-julia hljs">mask = sim.samples .&gt; 0;

logdos_shift = maximum(sim.logdos[mask]);

dos = exp.(sim.logdos[mask] .- logdos_shift);

scatter(Es[mask], dos; label = :none, xlabel = L&quot;E&quot;, ylabel = L&quot;g(E)&quot;, yscale = :log10, ms = 2, msw = 0)</code></pre><img src="d9e3629a.svg" alt="Example block output"/><h2 id="Critical-point"><a class="docs-heading-anchor" href="#Critical-point">Critical point</a><a id="Critical-point-1"></a><a class="docs-heading-anchor-permalink" href="#Critical-point" title="Permalink"></a></h2><p>The 2D Ising model has a continuous phase transition at <span>$\beta_c J = \log (1+\sqrt{2}) / 2 \approx 0.44\ldots$</span>, where <span>$\beta$</span> is inverse temperature. The output of the simulation is the entropy <span>$\log g(E)$</span>, i.e. the logarithm of the density of states, from which we can calculate moments of the energy</p><p class="math-container">\[\langle E^n \rangle = \frac{\sum_E E^n g(E) \exp(-\beta E)}{\sum_E g(E) \exp(-\beta E)}\]</p><p>To compute moments of the density of states from the output data we define </p><pre><code class="language-julia hljs">function moment_E(Es, g, n, β); E_factor = @. Es^n * exp(-Es * β); return dot(g, E_factor); end;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">moment_E (generic function with 1 method)</code></pre><p>where <code>Es</code> is the range of energy values, <code>g</code> is the corresponding density of states, <code>n</code> is the desired moment and <code>β</code> is an inverse temperature value. Using this we compute the partition function, the average energy and the specific heat (energy variance) as the 0th, 1st and 2nd moments, for a range of values of <span>$\beta$</span></p><pre><code class="language-julia hljs">βs = 0.1:0.01:1.0;

Z = [moment_E(Es[mask], dos, 0, β) for β in βs];

avgE = [moment_E(Es[mask], dos, 1, β) for β in βs];

avgE2 = [moment_E(Es[mask], dos, 2, β) for β in βs];

varE = @. (avgE2 / Z - (avgE / Z)^2) * βs^2;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">91-element Vector{Float64}:
  4.387637964988708
  5.363247366497958
  6.453200674048342
  7.6632535890671285
  8.999472061903397
 10.468172016655565
 12.075974521657894
 13.830046929381828
 15.738551909894419
 17.811236275507603
  ⋮
 19.030352035574523
 18.07505430226778
 17.170657636501765
 16.314231876047632
 15.50303633006215
 14.734504870821858
 14.006232650047354
 13.31596418249577
 12.661582591594197</code></pre><p>Now we can plot the average energy</p><pre><code class="language-julia hljs">plot(βs, avgE ./ Z ./ maxE; label = :none, xlabel = L&quot;\beta&quot;, ylabel = L&quot;\langle E \rangle / E_\mathrm{max}&quot;, xlim = (0, Inf))</code></pre><img src="413d4690.svg" alt="Example block output"/><p>and the specific heat, or variance</p><pre><code class="language-julia hljs">plot(βs, varE ./ L^2; label = :none, xlabel = L&quot;\beta&quot;, ylabel = L&quot;\mathrm{var}(E)&quot;, xlim = (0, Inf), ylim = (0, Inf))</code></pre><img src="d8e819a9.svg" alt="Example block output"/><p>Finally, the peak of the specific heat is a signature of the location of the critical point</p><pre><code class="language-julia hljs">varE_max, varE_max_i = findmax(varE);

varE_max / L^2, βs[varE_max_i]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(1.1120680337502982, 0.49)</code></pre><p>which compares well to the known value.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../advanced/">Advanced usage »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 8 December 2025 23:44">Monday 8 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
